%YAML 1.1
---

# Configuración Suricata - Proyecto RSE 2025

vars:
  address-groups:
    HOME_NET: "[10.0.0.0/24]"
    EXTERNAL_NET: "!$HOME_NET"
  
  port-groups:
    HTTP_PORTS: "80"

# Directorio de logs
default-log-dir: REEMPLAZAR_CON_RUTA_PROYECTO/logs/suricata

# Salidas
outputs:
  - fast:
      enabled: yes
      filename: fast.log
      append: yes
  
  - eve-log:
      enabled: yes
      filetype: regular
      filename: eve.json
      types:
        - alert:
            tagged-packets: yes
        - stats:
            totals: yes
            threads: no

  - stats:
      enabled: yes
      filename: stats.log
      append: yes
      totals: yes
      threads: no

# Captura (no se usa aquí, se especifica en línea de comandos)
af-packet:
  - interface: default
    cluster-id: 99
    cluster-type: cluster_flow

# Reglas
default-rule-path: REEMPLAZAR_CON_RUTA_PROYECTO/src/suricata
rule-files:
  - ddos_rules.rules

# Sistema
classification-file: /etc/suricata/classification.config
reference-config-file: /etc/suricata/reference.config

# Threading
threading:
  set-cpu-affinity: no
  detect-thread-ratio: 1.0

# Detección
detect:
  profile: medium
  sgh-mpm-context: auto

# Flow
flow:
  memcap: 128mb
  hash-size: 65536
  prealloc: 10000

# Stream
stream:
  memcap: 64mb
  checksum-validation: yes
  inline: auto
  reassembly:
    memcap: 256mb
    depth: 1mb

# Host
host:
  hash-size: 4096
  prealloc: 1000
  memcap: 32mb

# Logging
logging:
  default-log-level: notice
  outputs:
    - console:
        enabled: yes
    - file:
        enabled: yes
        level: info
        filename: REEMPLAZAR_CON_RUTA_PROYECTO/logs/suricata/suricata.log

# App layer
app-layer:
  protocols:
    http:
      enabled: yes
    dns:
      tcp:
        enabled: yes
      udp:
        enabled: yes

# Unix socket
unix-command:
  enabled: yes
  filename: /var/run/suricata-command.socket

# Runmode
runmode: autofp

# Decoder
decoder:
  teredo:
    enabled: false
  vxlan:
    enabled: false